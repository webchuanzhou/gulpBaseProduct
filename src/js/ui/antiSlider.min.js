(function(window){var HTMLS={ovl:'<div id="za-idcontrol"><div id="za-id-radar"><svg id="radar-init" width="16px" height="16px" viewBox="0 0 16 16" style="display: none"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-127.000000, -34.000000)" fill-rule="nonzero"><g transform="translate(115.000000, 24.000000)"><g transform="translate(12.000000, 10.000000)"><g><path d="M7.99212795,15.9842559 C3.57817342,15.9842559 0,12.4060825 0,7.99212795 C0,3.57817342 3.57817342,0 7.99212795,0 C12.4060825,0 15.9843719,3.57817342 15.9843719,7.99212795 C15.9843719,12.4060825 12.4060825,15.9842559 7.99212795,15.9842559 Z M7.99212795,0.999026854 C4.12993041,0.999026854 0.999012365,4.1299449 0.999012365,7.99214244 C0.999012365,11.85434 4.12993041,14.985258 7.99212795,14.985258 C11.8543255,14.985258 14.9851421,11.85434 14.9851421,7.99214244 C14.9851421,4.1299449 11.85434,0.999026854 7.99212795,0.999026854 Z M7.3462615,11.0773999 C7.15125943,11.2725034 6.8349717,11.2725034 6.63995514,11.0773999 C6.44485162,10.8823978 6.44485162,10.5661101 6.63995514,10.3709921 L9.81873233,7.99212795 L6.63998414,5.6132638 C6.44488061,5.41826172 6.44488061,5.101974 6.63998414,4.90685598 C6.83498621,4.71185391 7.15127394,4.71185391 7.3462905,4.90685598 L10.8784165,7.63888056 C11.0734186,7.83398408 11.0734186,8.15027181 10.8784165,8.34538983 L7.3462615,11.0773999 Z" id="za-anti-radar-init-path" fill="#4F7FF2"></path></g></g></g></g></g></svg><svg id="radar-loading" width="18px" height="17px" viewBox="0 0 18 17" ><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-126.000000, -411.000000)" fill-rule="nonzero" fill="#CCCCCC"><g transform="translate(115.000000, 401.000000)"><g transform="translate(20.000000, 18.400000) rotate(164.000000) translate(-20.000000, -18.400000) translate(12.000000, 10.000000)"><path id="za-anti-radar-loading-path" d="M8.10286845,1.30224671 C11.2508328,1.30224671 13.8981557,3.44169337 14.6731372,6.34512476 L14.6731372,6.25801893 C14.6731372,6.61772841 14.9645511,6.90914228 15.3242606,6.90914228 C15.6836806,6.90914228 15.9753839,6.61772841 15.9753839,6.25801893 C15.9849337,6.22560745 15.973937,6.19464293 15.9658341,6.16252083 C15.9571525,6.10406443 15.9423937,6.04792312 15.9192426,5.99525447 C14.990596,2.5440113 11.8478406,0 8.10286845,0 C3.62776995,0 0,3.62776995 0,8.10286845 C0,12.5779669 3.62776995,16.2057369 8.10286845,16.2057369 C11.8932746,16.2057369 15.0722035,13.6026904 15.9577312,10.0877818 C15.9643872,10.0299042 15.9753839,9.97202656 15.9753839,9.91125504 C15.9753839,9.55154556 15.6836807,9.26013169 15.3242606,9.26013169 C15.0004352,9.26013169 14.7339087,9.49714059 14.6835552,9.80707531 C13.9265158,12.7374198 11.2696431,14.9034902 8.10286845,14.9034902 C4.34689953,14.9034902 1.30224671,11.8588374 1.30224671,8.10286845 C1.30224671,4.34689953 4.34689953,1.30224671 8.10286845,1.30224671 Z"></path></g></g></g></g></svg><svg id="radar-success" width="16px" height="16px" viewBox="0 0 16 16" style="display: none"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-127.000000, -233.000000)"><g transform="translate(115.000000, 223.000000)"><g transform="translate(12.000000, 10.000000)" id="za-anti-radar-success-path" fill="#379C6C"><path d="M8,0 C3.58928571,0 0,3.58928571 0,8 C0,12.4107143 3.58928571,16 8,16 C12.4107143,16 16,12.4107143 16,8 C16,3.58928571 12.4107143,0 8,0 Z"></path><path d="M8,14.9816964 C4.15140763,14.9816964 1.01830357,11.8503417 1.01830357,8 C1.01830357,4.15140763 4.14965827,1.01830357 8,1.01830357 C11.8503417,1.01830357 14.9816964,4.15140763 14.9816964,8 C14.9816964,11.8503417 11.8503417,14.9816964 8,14.9816964 Z" fill="#FFFFFF"></path><path d="M11.2678571,5.30357143 L6.95357143,9.55357143 L4.73035714,7.39107143 C4.62857143,7.29285714 4.49464286,7.2375 4.35357143,7.2375 L4.34642857,7.2375 C4.20178571,7.23928571 4.06607143,7.29821429 3.96607143,7.40178571 C3.75892857,7.61607143 3.7625,7.95892857 3.97678571,8.16607143 L6.58035714,10.6982143 C6.68392857,10.8 6.82142857,10.85 6.95714286,10.85 C7.09464286,10.85 7.23214286,10.7982143 7.33571429,10.6964286 L12.0267857,6.075 C12.1303571,5.97321429 12.1875,5.8375 12.1892857,5.69464286 C12.1910714,5.55 12.1357143,5.41428571 12.0339286,5.31071429 C11.8232143,5.09642857 11.4803571,5.09464286 11.2678571,5.30357143 L11.2678571,5.30357143 Z" ></path></g></g></g></g></svg><svg id="radar-fail" width="16px" height="16px" viewBox="0 0 16 16" style="display: none"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-125.000000, -314.000000)"><g transform="translate(115.000000, 304.000000)"><g transform="translate(10.000000, 10.000000)" id="za-anti-radar-fail-path" fill="#EF4836"><path d="M8,16 C3.56923077,16 0,12.4307692 0,8 C0,3.56923077 3.56923077,0 8,0 C12.4307692,0 16,3.56923077 16,8 C16,12.4307692 12.4307692,16 8,16 Z"></path><path d="M8,1.23076923 C4.24615384,1.23076923 1.23076923,4.24615384 1.23076923,8 C1.23076923,11.7538462 4.24615384,14.7692308 8,14.7692308 C11.7538462,14.7692308 14.7692308,11.7538462 14.7692308,8 C14.7692308,4.24615384 11.7538462,1.23076923 8,1.23076923 L8,1.23076923 Z" fill="#FFFFFF"></path><path d="M6.64615384,7.38461539 C6.64615384,7.2 6.52307692,7.01538463 6.33846153,6.95384616 L3.32307692,5.53846153 C3.07692308,5.41538461 2.83076923,5.53846153 2.70769231,5.78461539 C2.58461539,6.03076923 2.70769231,6.33846155 2.95384616,6.46153847 L4.98461539,7.38461539 L2.83076923,8.36923077 C2.58461539,8.49230769 2.46153847,8.8 2.58461539,9.04615384 C2.64615386,9.23076923 2.83076923,9.35384616 3.01538461,9.35384616 C3.07692308,9.35384616 3.13846153,9.35384616 3.2,9.29230769 L6.33846153,7.87692308 C6.58461537,7.75384616 6.64615384,7.56923077 6.64615384,7.38461539 L6.64615384,7.38461539 Z" ></path><path d="M13.1692308,8.30769231 L11.0153846,7.38461539 L13.0461538,6.46153847 C13.2923077,6.33846155 13.4153846,6.03076923 13.2923077,5.78461539 C13.1692308,5.53846155 12.9230769,5.41538462 12.6769231,5.53846153 L9.66153847,6.95384616 C9.47692308,7.01538462 9.35384616,7.2 9.35384616,7.38461539 C9.35384616,7.56923078 9.47692308,7.75384616 9.66153847,7.81538461 L12.8,9.23076923 C12.8615385,9.2923077 12.9230769,9.2923077 12.9846154,9.29230769 C13.1692308,9.29230769 13.3538462,9.16923077 13.4153846,8.98461539 C13.5384615,8.73846155 13.4153846,8.43076923 13.1692308,8.30769231 L13.1692308,8.30769231 Z"></path><path d="M9.29230769,9.53846153 L6.70769231,9.53846153 C6.46153847,9.53846153 6.21538463,9.78461538 6.21538461,10.0307692 C6.21538459,10.2769231 6.46153845,10.5230769 6.70769231,10.5230769 L9.29230769,10.5230769 C9.53846153,10.5230769 9.78461538,10.2769231 9.78461539,10.0307692 C9.78461541,9.78461539 9.53846155,9.53846155 9.29230769,9.53846153 Z" ></path></g></g></g></g></svg><svg id="radar-pending" width="18px" height="16px" viewBox="0 0 18 4" style="display: none"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-569.000000, -262.000000)" fill="#D8D8D8" id="za-anti-radar-pending-path"><g transform="translate(569.000000, 262.000000)"><circle cx="2" cy="2" r="2"></circle><circle cx="9" cy="2" r="2"></circle><circle cx="16" cy="2" r="2"></circle></g></g></g></svg></div><span id="za-id-label">姝ｅ湪鍔犺浇楠岃瘉</span></div>',dialogp:'<div id="za-id-dialog"><svg id="dialog-arrow" style="width: 15px; height: 18px; transform: rotate(270deg); position: absolute; left: -13px; top: 46%;" viewBox="35 54 15 18" stroke="#EDEDED"><polyline points="33,71 43,56 52,71 " strokeWidth="2" fill="#fff" /></svg><div id="za-id-dialog-container"><header id="za-id-dialog-header" ><div style="display: inline-block; vertical-align: super;">璇蜂緷娆＄偣鍑�</div><img id="za-id-dialog-header-img" style="padding-left: 10px;"/></header><div id="za-id-dialog-control"><img id="za-id-dialog-img" /></div><footer id="za-id-dialog-footer" ><svg id="za-id-dialog-refresh" width="16px" height="15px" style="cursor: pointer" viewBox="0 0 16 15" ><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-695.000000, -141.000000)" fill-rule="nonzero" fill="#666666"><g transform="translate(695.000000, 141.000000)"><g><path id="za-anti-radar-refresh-path" d="M15.8421813,6.68313408 C15.6419835,6.47833408 15.288761,6.47660823 15.0851116,6.67680599 L14.7341903,7.02139924 C14.5483745,3.07497228 11.3411835,0.00239699775 7.37634756,0.00239699775 C3.31026217,0.00239699775 0.00239699775,3.31026217 0.00239699775,7.37634756 C0.00239699775,11.4430082 3.31026217,14.7508734 7.37634756,14.7508734 C9.54285542,14.7508734 11.5937318,13.7918801 12.9945408,12.1287431 C13.0572464,12.0809948 13.1078712,12.0240419 13.1458397,11.9590352 C13.1515925,11.9527071 13.15677,11.9469543 13.1619476,11.9406262 L13.1987655,11.8836734 L13.1861094,11.8779206 C13.2102712,11.8140644 13.2217768,11.7525094 13.2217768,11.6898037 C13.2217768,11.3826037 12.9721049,11.1329318 12.6649049,11.1329318 C12.4802397,11.1329318 12.3076554,11.2313049 12.206406,11.3900824 C11.0057948,12.8328869 9.2454352,13.6601408 7.37634756,13.6601408 C3.91143071,13.6601408 1.0925543,10.8412644 1.0925543,7.37634756 C1.0925543,3.91200599 3.91143071,1.09312958 7.37634756,1.09312958 C10.8182532,1.09312958 13.6227476,3.87461273 13.6595655,7.30731385 L13.0342352,6.68025767 C12.8323116,6.47718351 12.4796644,6.47660823 12.2771655,6.67910711 C12.0677633,6.88793408 12.067188,7.22792509 12.276015,7.43675205 L13.5962846,8.7604734 C13.6975341,8.86172284 13.8321498,8.91752509 13.9748195,8.91752509 L13.9805723,8.91694981 L13.9949543,8.92097677 C14.0248689,8.92903071 14.0588105,8.93765992 14.0950532,8.93765992 C14.235997,8.93765992 14.3694622,8.88300823 14.4701363,8.7846352 L15.8358532,7.44077902 C15.9382532,7.34010486 15.995206,7.20491385 15.9963565,7.06224419 C15.9975071,6.91899924 15.9422801,6.7849588 15.8421813,6.68313408"></path></g></g></g></g></svg><svg id="za-id-dialog-close" width="14px" height="14px" style="cursor: pointer; margin-left: 10px" viewBox="0 0 14 14"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-727.000000, -141.000000)" fill-rule="nonzero" fill="#666666"><g transform="translate(695.000000, 141.000000)"><g transform="translate(32.000000, 0.000000)"><path id="za-anti-radar-close-path" d="M0.141655282,13.8581197 C0.226754825,13.9432192 0.338475251,13.9855508 0.450195677,13.9855508 C0.561916104,13.9855508 0.67363653,13.9427828 0.759172481,13.8576833 L6.9963144,7.61312244 L13.2334563,13.8576833 C13.3185559,13.9432192 13.4302763,13.9855508 13.5424331,13.9855508 C13.6541535,13.9855508 13.765874,13.9427828 13.8509735,13.8581197 C14.021609,13.6879206 14.021609,13.4116744 13.8514099,13.2410389 L7.62037772,7.00302417 L13.8509735,0.765445845 C14.0211726,0.59481035 14.0211726,0.31856414 13.8505371,0.148365053 C13.6794652,-0.0222704414 13.4036554,-0.0222704414 13.2334563,0.148801461 L6.99587799,6.39336231 L0.758736073,0.148801461 C0.588100578,-0.0218340335 0.311854368,-0.0218340335 0.141655282,0.148365053 C-0.0289802131,0.31856414 -0.0289802131,0.59481035 0.141218874,0.765445845 L6.37137826,7.00302417 L0.141218874,13.2410389 C-0.0289802131,13.411238 -0.0289802131,13.6879206 0.141655282,13.8581197 Z"></path></g></g></g></g></svg></footer></div></div>',modal:'<div id="za-id-dialog-overlay"></div>'};function ClickIdentifyControl(options){var config={};this.get=function(n){return config[n]};this.set=function(n,v){config[n]=v};var $jsonp=function(){var that={};that.send=function(src,options){var callback_name=options.callbackName||"callback",on_success=options.onSuccess||function(){},on_timeout=options.onTimeout||function(){},timeout=options.timeout||30;var timeout_trigger=window.setTimeout(function(){window[callback_name]=function(){};on_timeout()},timeout*1e3);window[callback_name]=function(data){window.clearTimeout(timeout_trigger);on_success(data)};var script=document.createElement("script");script.type="text/javascript";script.async=true;script.src=src;document.getElementsByTagName("head")[0].appendChild(script)};return that}();function onLoadDunkey(){if(dunkey){var host=this.get("dunkeyhost");var onDunkeyLoad=this.get("onDunkeyLoad");dunkey.run(this.get("sId"),{ana:{host:host+"/trace.jsonp",path:""},is_af:true},function(did,token){changeState(did,token);bindEvent();onDunkeyLoad&&onDunkeyLoad()})}}function createDom(options){var container=options&&options.container?options.container:"body";var containerEl=document.querySelector(container);if(containerEl){containerEl.innerHTML=""}var self=this;containerEl.insertAdjacentHTML("beforeend",HTMLS.ovl);var sliderEl=document.querySelector(container+" #za-idcontrol");var txtEl=document.querySelector(container+" #za-id-label");var radarEl=document.querySelector(container+" #za-id-radar");var radarInitEl=document.querySelector(container+" #radar-init");var radarLoadEl=document.querySelector(container+" #radar-loading");var radarSuccEl=document.querySelector(container+" #radar-success");var radarFailEl=document.querySelector(container+" #radar-fail");var radarPendingEl=document.querySelector(container+" #radar-pending");var phoneInputEl=document.querySelector(container+" .seraph-phone");var mailInputEl=document.querySelector(container+" .seraph-email");var idcardInputEl=document.querySelector(container+" .seraph-idcard");var bankcardInputEl=document.querySelector(container+" .seraph-bankcard");var body=document.querySelector("body");sliderEl.style.width=options&&options.width?options.width:"100%";sliderEl.style.height=options&&options.height?options.height:"100%";sliderEl.style.lineHeight=sliderEl.style.height;sliderEl.style.backgroundColor=options&&options.backgroundColor?options.backgroundColor:"#FFF";var host=options&&options.host?options.host:"https://af.zhongan.io";var dunkeyhost=options&&options.dunkeyhost?options.dunkeyhost:host;var placeholdLabel=options&&options.placeholdLabel?options.placeholdLabel:"鏅鸿兘妫€娴嬩腑";var timeout=options&&options.timeout?options.timeout:30;var modal=options&&options.modal?options.modal:false;this.set("ovl",sliderEl);this.set("txtEl",txtEl);this.set("radar",radarEl);this.set("radarInitEl",radarInitEl);this.set("radarLoadEl",radarLoadEl);this.set("radarSuccEl",radarSuccEl);this.set("radarFailEl",radarFailEl);this.set("radarPendingEl",radarPendingEl);this.set("phoneInputEl",phoneInputEl);this.set("mailInputEl",mailInputEl);this.set("idcardInputEl",idcardInputEl);this.set("bankcardInputEl",bankcardInputEl);this.set("host",host);this.set("dunkeyhost",dunkeyhost);this.set("placeholdLabel",placeholdLabel);this.set("timeout",timeout);this.set("modal",modal);this.set("destroy",destroy);this.set("sId",options.sId);this.set("body",body);this.set("onSuccess",options.onSuccess);this.set("onFail",options.onFail);this.set("onFetchError",options.onFetchError);this.set("onPacmanComplete",options.onPacmanComplete);this.set("onOpenDialog",options.onOpenDialog);this.set("onCloseDialog",options.onCloseDialog);this.set("onDunkeyLoad",options.onDunkeyLoad);this.set("onClickStartAnalyze",options.onClickStartAnalyze)}function bindEvent(){var _this=this,bt=_this.get("sd_bt"),ovl=this.get("ovl"),body=this.get("body"),close=this.get("dialogCloseEl");ovl.addEventListener("click",clickHandler)}function resizing(){var ovl=this.get("ovl"),dialogpEl=this.get("dialogpEl");var ovlPosition=ovl.getBoundingClientRect();dialogpEl.style.left=ovlPosition.left+40+"px";dialogpEl.style.top=ovlPosition.top-dialogpEl.getBoundingClientRect().height/2+ovlPosition.height/2+window.pageYOffset+"px"}function changeState(did,token){var radar=this.get("radar"),ovl=this.get("ovl"),txtEl=this.get("txtEl"),radarInit=this.get("radarInitEl"),radarLoadEl=this.get("radarLoadEl"),radarSuccEl=this.get("radarSuccEl"),radarFailEl=this.get("radarFailEl"),radarPendingEl=this.get("radarPendingEl");radarInit.style.display="block";radarSuccEl.style.display="none";radarFailEl.style.display="none";radarPendingEl.style.display="none";radarLoadEl.style.display="none";radar.className=radar.className.replace("annimate_rotate","");ovl.className=ovl.className.replace(/loading|success|fail/gi,"");txtEl.innerHTML="鐐瑰嚮姝ら獙璇�";this.set("did",did);this.set("token",token)}function fetchJsonP(url,callbackName,onSuccess,onTimeout,timeout){if(!window.navigator.onLine){onTimeout("no network access");return}if(window.fetchJsonp){fetchJsonp(url,{timeout:timeout*1e3,jsonpCallback:"custom_callback",jsonpCallbackFunction:callbackName}).then(function(response){return response.json()}).then(function(json){onSuccess(json)}).catch(function(ex){onTimeout(ex)})}else{$jsonp.send(url,{callbackName:callbackName,onSuccess:onSuccess,onTimeout:onTimeout,timeout:timeout})}}function clickHandler(e){var self=this,radar=this.get("radar"),ovl=this.get("ovl"),txtEl=this.get("txtEl"),radarInit=this.get("radarInitEl"),radarLoadEl=this.get("radarLoadEl"),radarSuccEl=this.get("radarSuccEl"),radarFailEl=this.get("radarFailEl"),radarPendingEl=this.get("radarPendingEl"),did=this.get("did"),token=this.get("token"),sId=this.get("sId"),payload=this.get("payload"),self=this,host=this.get("host"),phoneInputEl=this.get("phoneInputEl"),mailInputEl=this.get("mailInputEl"),idcardInputEl=this.get("idcardInputEl"),bankcardInputEl=this.get("bankcardInputEl"),placeholdLabel=this.get("placeholdLabel"),timeout=this.get("timeout"),onFetchError=this.get("onFetchError"),onClickStartAnalyze=this.get("onClickStartAnalyze");radarInit.style.display="none";radarSuccEl.style.display="none";radarFailEl.style.display="none";radarPendingEl.style.display="none";radarLoadEl.style.display="block";radar.className=radar.className.replace("annimate_rotate","");radar.className+="annimate_rotate";ovl.className=ovl.className.replace(/loading|success|fail/gi,"");ovl.className+="loading";txtEl.innerHTML=placeholdLabel;this.set("analyzeFail",false);ovl.removeEventListener("click",clickHandler);onClickStartAnalyze&&onClickStartAnalyze();setTimeout(function(){var callbackName="handleStuff_"+(new Date).getTime();var url=host+"/api/v1/analyze.jsonp?"+"callback="+callbackName+"&did="+did+"&token="+encodeURIComponent(token)+"&s="+encodeURIComponent(sId)+"&payload="+JSON.stringify(payload);if(phoneInputEl&&phoneInputEl.tagName==="INPUT"&&phoneInputEl.value){url+="&phone="+encodeURIComponent(phoneInputEl.value)}if(mailInputEl&&mailInputEl.tagName==="INPUT"&&mailInputEl.value){url+="&mail="+encodeURIComponent(mailInputEl.value)}if(idcardInputEl&&idcardInputEl.tagName==="INPUT"&&idcardInputEl.value){url+="&idcard="+encodeURIComponent(idcardInputEl.value)}if(bankcardInputEl&&bankcardInputEl.tagName==="INPUT"&&bankcardInputEl.value){url+="&bankcard="+encodeURIComponent(bankcardInputEl.value)}fetchJsonP(url,callbackName,function(json){var result="fail";var slider_params=null;if(json.data.result==="reject"){result="fail"}else if(json.data.result==="pass"){result="success"}else if(json.data.result==="review"){result=json.data.slider===1?"pending2":"pending1";slider_params=json.data.slider===2?json.data.slider_params:null}onResultBack(result,slider_params)},function(e){onFetchError&&onFetchError(e);self.set("analyzeFail",true);if(e!=="no network access"){onResultBack("pending2",null)}},timeout)},500)}function onResultBack(value,params){var self=this,radar=this.get("radar"),ovl=this.get("ovl"),txtEl=this.get("txtEl"),radarInit=this.get("radarInitEl"),radarLoadEl=this.get("radarLoadEl"),radarSuccEl=this.get("radarSuccEl"),radarFailEl=this.get("radarFailEl"),radarPendingEl=this.get("radarPendingEl"),body=this.get("body"),did=this.get("did"),token=this.get("token"),sId=this.get("sId"),onSuccess=this.get("onSuccess"),onFail=this.get("onFail"),modal=this.get("modal"),payload=this.get("payload");radarInit.style.display="none";radarSuccEl.style.display="none";radarLoadEl.style.display="none";radarFailEl.style.display="none";radarPendingEl.style.display="none";radar.className=radar.className.replace(/annimate_rotate/gi,"");ovl.className=ovl.className.replace(/loading|success|fail/gi,"");if(value==="success"){radarSuccEl.style.display="block";ovl.className+="success";txtEl.innerHTML="楠岃瘉鎴愬姛";ovl.removeEventListener("click",clickHandler);if(onSuccess){onSuccess(did,token,sId,payload)}}else if(value==="fail"){radarFailEl.style.display="block";ovl.className+="fail";txtEl.innerHTML="璇风偣鍑婚噸璇�";ovl.addEventListener("click",clickHandler);onFail&&onFail()}else{closeDialog();ovl.className+="loading";radarPendingEl.style.display="block";document.querySelector("body").insertAdjacentHTML("beforeend",HTMLS.dialogp);if(modal){document.querySelector("body").insertAdjacentHTML("beforeend",HTMLS.modal);var dialogpOverlayEl=document.querySelector("#za-id-dialog-overlay");this.set("dialogpOverlayEl",dialogpOverlayEl)}var dialogpEl=document.querySelector("#za-id-dialog");var controlEl=document.querySelector("#za-id-dialog-control");var headerEl=document.querySelector("#za-id-dialog-header");var refreshEl=document.querySelector("#za-id-dialog-refresh");var dialogImgEl=document.querySelector("#za-id-dialog-img");var ovlPosition=ovl.getBoundingClientRect();var dialogW=ovlPosition.width-40;dialogImgEl.style.display="none";dialogpEl.style.width=dialogW+"px";dialogpEl.style.left=ovlPosition.left+40+"px";if(value==="pending2"){dialogpEl.style.height="130px";controlEl.style.height="48px";function callback(trace){sendDetectCall(1,trace)}if(PacManIdentify){var pmSlider=new PacManIdentify({container:"#za-id-dialog-control",onComplete:function(trace){var analyzeFail=self.get("analyzeFail");var onPacmanComplete=self.get("onPacmanComplete");if(analyzeFail){onPacmanComplete&&onPacmanComplete();closeDialog();onResultBack("success")}else{setTimeout(function(){callback(trace)},500)}}});this.set("pmSlider",pmSlider)}headerEl.innerHTML="璇锋嫋鍔ㄥ悆璞嗕汉鍚冨畬鎵€鏈夎眴璞�";refreshEl.style.display="none"}else{dialogpEl.style.height=dialogW*.8+"px";var dialogImgEl=document.querySelector("#za-id-dialog-img");var dialogHeaderEl=document.querySelector("#za-id-dialog-header");var refreshEl=document.querySelector("#za-id-dialog-refresh");var headerImgEl=document.querySelector("#za-id-dialog-header-img");refreshEl.style.display="inline-block";dialogImgEl.style.display="block";this.set("dialogImgEl",dialogImgEl);this.set("dialogHeaderEl",dialogHeaderEl);this.set("dialogHeaderImgEl",headerImgEl);updateImg(params)}dialogpEl.style.top=ovlPosition.top-dialogpEl.getBoundingClientRect().height/2+ovlPosition.height/2+window.pageYOffset+"px";var dialogCloseEl=document.querySelector("#za-id-dialog-close");var refreshEl=document.querySelector("#za-id-dialog-refresh");this.set("dialogpEl",dialogpEl);this.set("dialogCloseEl",dialogCloseEl);this.set("refreshEl",refreshEl);bindDialogEvent();var onOpenDialog=this.get("onOpenDialog");onOpenDialog&&onOpenDialog()}}function imgClickHandler(e){var dialogImgEl=this.get("dialogImgEl");var clickTrace=this.get("clickTrace");var clickTotalCount=this.get("clickTotalCount");var boundRect=dialogImgEl.getBoundingClientRect();var x=Math.round(e.pageX-boundRect.left)/boundRect.width;var y=Math.round(e.pageY-boundRect.top-window.pageYOffset)/boundRect.height;clickTrace.push([Number(x.toFixed(2)),Number(y.toFixed(2))]);var style="width: 35px; height: 35px; background: rgba(168, 225, 245, 0.5); position: absolute; border-radius: 20px;"+"left: "+e.offsetX+"px; top: "+(e.offsetY+20)+"px";var circle='<div id="click_circle" style="'+style+'"></div>';document.querySelector("#za-id-dialog-control").insertAdjacentHTML("beforeend",circle);if(clickTrace.length===clickTotalCount){sendDetectCall(2,clickTrace);this.set("clickTotalCount",0);this.set("clickTrace",[]);dialogImgEl.removeEventListener("click",imgClickHandler)}}function strRepeat(target,n){return new Array(n+1).join(target)}function XOREncode(d){var token=this.get("token");var k;if(d.length>token.length){k=strRepeat(token,Math.floor(d.length/token.length))+token.substring(0,d.length%token.length)}else{k=token.substring(0,d.length)}var encodeStr="";for(i=0;i<d.length;i++){encodeStr+=String.fromCharCode(d[i].charCodeAt(0).toString(10)^k[i].charCodeAt(0).toString(10))}return encodeStr}function stringToByteArr(str){var array=new Array(str.length);var i;var il;for(i=0,il=str.length;i<il;++i){array[i]=str.charCodeAt(i)&255}return array}function byteToString(uint8arr){if(!uint8arr){return""}return String.fromCharCode.apply(null,new Uint8Array(uint8arr))}function compressData(trace){if(window.LZString){return"&dtype=lz&d="+encodeURIComponent(LZString.compressToBase64(XOREncode(JSON.stringify(trace))))}if(window.Zlib){var gzip=new Zlib.Gzip(stringToByteArr(XOREncode(JSON.stringify(trace))));var compressed_fp_json=byteToString(gzip.compress());var base64_fp=window.btoa(compressed_fp_json).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,".");return"&dt=dt&d="+base64_fp}return"&d="+encodeURIComponent(JSON.stringify(trace))}function sendDetectCall(slider,trace){var did=this.get("did"),token=this.get("token"),sId=this.get("sId"),host=this.get("host"),timeout=this.get("timeout"),onFetchError=this.get("onFetchError");var callbackName="handleStuff_"+(new Date).getTime();var url=host+"/api/v1/antibot.jsonp?"+"callback="+callbackName+"&did="+did+"&token="+encodeURIComponent(token)+"&s="+encodeURIComponent(sId)+"&slider="+slider+compressData(trace);fetchJsonP(url,callbackName,function(json){if(slider===2&&!json.result){wrongPictureValidate(json.idx)}else{closeDialog();onResultBack(json.result?"success":"fail")}},function(e){onFetchError&&onFetchError(e);closeDialog();onResultBack("fail");console.log("timeout!")},timeout)}function refreshImg(){var did=this.get("did"),token=this.get("token"),sId=this.get("sId"),host=this.get("host"),timeout=this.get("timeout"),onFetchError=this.get("onFetchError"),refreshEl=this.get("refreshEl");var callbackName="handleStuff_"+(new Date).getTime();var url=host+"/api/v1/recaptcha.jsonp?"+"callback="+callbackName+"&did="+did+"&token="+encodeURIComponent(token)+"&s="+encodeURIComponent(sId);if(refreshEl){refreshEl.style.pointerEvents="none";refreshEl.style.opacity=.5;setTimeout(function(){if(refreshEl){refreshEl.style.pointerEvents="auto";refreshEl.style.opacity=1}},1e3)}fetchJsonP(url,callbackName,function(json){if(json.result){updateImg(json.slider_params)}else{tooManyRefreshPicture()}},function(e){onFetchError&&onFetchError(e);closeDialog();onResultBack("fail")},timeout)}function tooManyRefreshPicture(){var dialogImgEl=this.get("dialogImgEl");var dialogHeaderEl=this.get("dialogHeaderEl");var message='<div id="img_message" class="zoomin" style="position: absolute;bottom: 35px;font-size: 12px;background: rgba(239,72,54,60);color: #D8D8D8; width: 90%; text-indent: 10px;">鍥剧墖鍒锋柊澶揩,璇蜂紤鎭竴涓嬶綖</div>';document.querySelector("#za-id-dialog-control").insertAdjacentHTML("beforeend",message);setTimeout(function(){dialogImgEl.className=dialogImgEl.className.replace(/shake2/gi,"");var messageEl=document.querySelector("#img_message");var container=document.querySelector("#za-id-dialog-control");container&&messageEl&&container.removeChild(messageEl)},4e3)}function wrongPictureValidate(index){var dialogImgEl=this.get("dialogImgEl");var dialogHeaderEl=this.get("dialogHeaderEl");var message='<div id="img_message" class="zoomin" style="position: absolute;bottom: 35px;font-size: 12px;background: rgba(239,72,54,60);color: #D8D8D8; width: 90%; text-indent: 10px;">鐐瑰嚮鏈夎锛岃鎸夐『搴忕偣鍑伙綖</div>';document.querySelector("#za-id-dialog-control").insertAdjacentHTML("beforeend",message);setTimeout(function(){dialogImgEl.className=dialogImgEl.className.replace(/shake2/gi,"");refreshImg()},2e3)}function updateImg(params){var dialogImgEl=this.get("dialogImgEl");var img_container=document.querySelector("#za-id-dialog-control");img_container.innerHTML="";img_container.appendChild(dialogImgEl);dialogImgEl.src="data:image/png;base64, "+params.img;var dialogHeaderEl=this.get("dialogHeaderEl");var dialogHeaderImgEl=this.get("dialogHeaderImgEl");dialogHeaderImgEl.src="data:image/png;base64, "+params.desc_img;this.set("clickTotalCount",params.num);this.set("clickTrace",[]);dialogImgEl.addEventListener("click",imgClickHandler)}function bindDialogEvent(){var _this=this,close=this.get("dialogCloseEl"),refreshEl=this.get("refreshEl");close.addEventListener("click",closeDialog);refreshEl.addEventListener("click",refreshImg);window.addEventListener("resize",resizing)}function closeDialog(e){var close=this.get("dialogCloseEl"),refreshEl=this.get("refreshEl"),body=this.get("body"),pmSlider=this.get("pmSlider"),onCloseDialog=this.get("onCloseDialog");close&&close.removeEventListener("click",closeDialog);refreshEl&&refreshEl.removeEventListener("click",refreshImg);window.removeEventListener("resize",resizing);if(pmSlider){pmSlider.destroy();this.set("pmSlider",null)}var dialogEl=this.get("dialogpEl")||document.querySelector("#za-id-dialog");if(body.contains(dialogEl)){body.removeChild(dialogEl);var overlay=this.get("dialogpOverlayEl")||document.querySelector("#za-id-dialog-overlay");overlay&&body.removeChild(overlay);if(e){onResultBack("fail")}onCloseDialog&&onCloseDialog()}}function destroy(){var ovl=this.get("ovl");ovl&&ovl.removeEventListener("click",clickHandler);closeDialog();ovl&&ovl.parentNode&&ovl.parentNode.removeChild(ovl)}var createDom=createDom.bind(this,options);var bindEvent=bindEvent.bind(this);var onLoadDunkey=onLoadDunkey.bind(this);var clickHandler=clickHandler.bind(this);var changeState=changeState.bind(this);var onResultBack=onResultBack.bind(this);var bindDialogEvent=bindDialogEvent.bind(this);var closeDialog=closeDialog.bind(this);var updateImg=updateImg.bind(this);var sendDetectCall=sendDetectCall.bind(this);var imgClickHandler=imgClickHandler.bind(this);var wrongPictureValidate=wrongPictureValidate.bind(this);var tooManyRefreshPicture=tooManyRefreshPicture.bind(this);var refreshImg=refreshImg.bind(this);var resizing=resizing.bind(this);var XOREncode=XOREncode.bind(this);var destroy=destroy.bind(this);function init(options){createDom(options);onLoadDunkey()}init()}ClickIdentifyControl.prototype={setPayload:function(payload){this.set("payload",payload)},startAnalyze:function(){var ovl=this.get("ovl")?this.get("ovl"):document.querySelector("#za-idcontrol");ovl.click()},destroy:function(){var destroy=this.get("destroy");destroy()}};window.ClickIdentifyControl=ClickIdentifyControl})(window);(function(window){var HTMLS={ovl:'<div id="wrapper_sd"><div id="bg_el"></div><div id="sd_bt"><div id="pk_man"><svg class="pkman_eating1" width="48px" height="48px" viewBox="0 0 48 48"><defs><path d="M977.966798,123.404697 C975.485094,120.009406 971.486536,118 967.224175,118 C959.920846,118 954,123.801553 954,130.951178 C954,133.735909 954.896619,136.315512 956.422414,138.42793 C959.931382,136.009616 977.966798,123.404697 977.966798,123.404697 Z M969.415722,121.958844 C970.366969,121.958844 971.137913,122.714375 971.137913,123.646316 C971.137913,124.578319 970.366969,125.333819 969.415722,125.333819 C968.464629,125.333819 967.693409,124.578288 967.693409,123.646316 C967.693409,122.714375 968.464629,121.958844 969.415722,121.958844 Z" id="pkman-eating1"></path><filter x="-102.2%" y="-110.1%" width="304.4%" height="354.6%" filterUnits="objectBoundingBox"><feOffset dx="0" dy="5" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.05 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix><feOffset dx="0" dy="0" in="SourceAlpha" result="shadowOffsetOuter2"></feOffset><feGaussianBlur stdDeviation="7.5" in="shadowOffsetOuter2" result="shadowBlurOuter2"></feGaussianBlur><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.05 0" type="matrix" in="shadowBlurOuter2" result="shadowMatrixOuter2"></feColorMatrix><feMerge><feMergeNode in="shadowMatrixOuter1"></feMergeNode><feMergeNode in="shadowMatrixOuter2"></feMergeNode></feMerge></filter></defs><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-939.000000, -103.000000)" fill-rule="nonzero"><g><use fill="black" fill-opacity="1" filter="url(#filter-2)" xlink:href="#pkman-eating1"></use><use fill="#5282EF" fill-rule="evenodd" xlink:href="#pkman-eating1"></use></g></g></g></svg><svg class="pkman_eating2" width="48px" height="48px" viewBox="0 0 48 48"><defs><path d="M956.724632,152.077659 C955.015695,154.25996 954,156.989941 954,159.951178 C954,167.107176 959.920815,172.908606 967.224175,172.908606 C971.351401,172.908606 975.247244,171.018861 977.748131,167.799858 C977.748131,167.799858 959.259903,154.053274 956.724632,152.077659 Z" id="pkman_eating2"></path><filter x="-103.2%" y="-108.0%" width="306.3%" height="349.6%" filterUnits="objectBoundingBox"><feOffset dx="0" dy="5" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.05 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix><feOffset dx="0" dy="0" in="SourceAlpha" result="shadowOffsetOuter2"></feOffset><feGaussianBlur stdDeviation="7.5" in="shadowOffsetOuter2" result="shadowBlurOuter2"></feGaussianBlur><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.05 0" type="matrix" in="shadowBlurOuter2" result="shadowMatrixOuter2"></feColorMatrix><feMerge><feMergeNode in="shadowMatrixOuter1"></feMergeNode><feMergeNode in="shadowMatrixOuter2"></feMergeNode></feMerge></filter></defs><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-939.000000, -139.000000)" fill-rule="nonzero"><g><use fill="black" fill-opacity="1" filter="url(#filter-2)" xlink:href="#pkman_eating2"></use><use fill="#5282EF" fill-rule="evenodd" xlink:href="#pkman_eating2"></use></g></g></g></svg></div><svg id="pk_man_success" width="56px" height="48px" viewBox="0 0 56 56" style="display: none"><defs><path d="M13,0 C5.80582524,0 0,5.80582524 0,13 C0,20.1941748 5.80582524,26 13,26 C20.1941748,26 26,20.1941748 26,13 C26,5.80582524 20.0679612,0 13,0 Z" id="pkman_success"></path><filter x="-94.2%" y="-86.5%" width="288.5%" height="300.0%" filterUnits="objectBoundingBox"><feOffset dx="0" dy="5" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.05 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix><feOffset dx="0" dy="0" in="SourceAlpha" result="shadowOffsetOuter2"></feOffset><feGaussianBlur stdDeviation="7.5" in="shadowOffsetOuter2" result="shadowBlurOuter2"></feGaussianBlur><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.05 0" type="matrix" in="shadowBlurOuter2" result="shadowMatrixOuter2"></feColorMatrix><feMerge><feMergeNode in="shadowMatrixOuter1"></feMergeNode><feMergeNode in="shadowMatrixOuter2"></feMergeNode></feMerge></filter></defs><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-779.000000, -575.000000)" fill-rule="nonzero"><g transform="translate(794.000000, 590.000000)"><g><use fill="black" fill-opacity="1" filter="url(#filter-2)" xlink:href="#pkman_success"></use><use fill="#5282EF" fill-rule="evenodd" xlink:href="#pkman_success"></use></g><path d="M5,15.731165 C5,15.731165 5.8,21.9711651 13,21.9711651 C20.36,21.9711651 21,15.731165 21,15.731165 L13,15.731165 L5,15.731165 Z" fill="#FFFFFF"></path><path d="M7,12 C8.16666669,12 9,11.1666667 9,10 C9,9.50000004 8.83333332,9.00000002 8.50000001,8.6666667 C8.33333333,8.49999999 8.16666669,8.49999999 8.16666669,8.33333332 C7.83333334,8.16666668 7.33333335,8 7,8 C5.83333331,8 5,8.83333334 5,10 C5,11.1666667 5.83333334,12 7,12 Z" fill="#FFFFFF"></path><path d="M17,10 C17,11.1045695 17.8954305,12 19,12 C20.1045695,12 21,11.1045695 21,10 C21,8.8954305 20.1045695,8 19,8 C17.8954305,8 17,8.8954305 17,10 Z" fill="#FFFFFF"></path></g></g></g></svg><svg id="pk_man_fail" width="57px" height="48px" viewBox="0 0 57 57" style="display: none"><defs><path d="M13.5,0 C6.0564375,0 0,6.0564375 0,13.5 C0,20.9435625 6.0564375,27 13.5,27 C20.9435625,27 27,20.9435625 27,13.5 C27,6.0564375 20.9435625,0 13.5,0 Z" id="pkman_fail"></path><filter x="-90.7%" y="-83.3%" width="281.5%" height="292.6%" filterUnits="objectBoundingBox"><feOffset dx="0" dy="5" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.05 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix><feOffset dx="0" dy="0" in="SourceAlpha" result="shadowOffsetOuter2"></feOffset><feGaussianBlur stdDeviation="7.5" in="shadowOffsetOuter2" result="shadowBlurOuter2"></feGaussianBlur><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.05 0" type="matrix" in="shadowBlurOuter2" result="shadowMatrixOuter2"></feColorMatrix><feMerge><feMergeNode in="shadowMatrixOuter1"></feMergeNode><feMergeNode in="shadowMatrixOuter2"></feMergeNode></feMerge></filter></defs><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-689.000000, -727.000000)"><g transform="translate(704.000000, 742.000000)"><g fill-rule="nonzero"><use fill="black" fill-opacity="1" filter="url(#filter-2)" xlink:href="#pkman_fail"></use><use fill="red" fill-rule="evenodd" xlink:href="#pkman_fail"></use></g><path d="M13.5,25.4120625 C6.9305625,25.4120625 1.5879375,20.0694375 1.5879375,13.5 C1.5879375,6.9305625 6.9305625,1.5879375 13.5,1.5879375 C20.0694375,1.5879375 25.4120625,6.9305625 25.4120625,13.5 C25.4120625,20.0694375 20.0694375,25.4120625 13.5,25.4120625 Z" fill="#FFFFFF"></path><path d="M16.875,10.125 C16.875,11.0569805 17.6305195,11.8125 18.5625,11.8125 C19.4944805,11.8125 20.25,11.0569805 20.25,10.125 C20.25,9.19301948 19.4944805,8.4375 18.5625,8.4375 C17.6305195,8.4375 16.875,9.19301948 16.875,10.125 Z" fill="#EF4836" fill-rule="nonzero"></path><path d="M6.75,10.125 C6.75,11.0569805 7.50551948,11.8125 8.4375,11.8125 C9.36948052,11.8125 10.125,11.0569805 10.125,10.125 C10.125,9.19301948 9.36948052,8.4375 8.4375,8.4375 C7.50551948,8.4375 6.75,9.19301948 6.75,10.125 Z" fill="#EF4836" fill-rule="nonzero"></path><path d="M13.608,15.7426875 C11.1897892,15.6999524 8.91988098,16.9050441 7.6005,18.9320625 C7.34560333,19.3225623 7.45553141,19.8457596 7.84603125,20.1006562 C8.23653109,20.3555529 8.75972833,20.2456248 9.014625,19.855125 C10.0158074,18.3122243 11.7420387,17.3948848 13.581,17.4285 C15.3405342,17.4591327 16.9731521,18.3507981 17.9499375,19.814625 C18.0728066,20.0020981 18.2656076,20.1325864 18.4853184,20.1769724 C18.7050292,20.2213584 18.9333652,20.1759483 19.119375,20.050875 C19.5065264,19.7914156 19.610689,19.2675833 19.35225,18.87975 C18.0686865,16.9543738 15.9216715,15.7818412 13.608,15.7426875 L13.608,15.7426875 Z" fill="#EF4836" fill-rule="nonzero"></path></g></g></g></svg></div><div id="ft_el"><div class="ft_circle" ></div><div class="ft_circle_space"></div><div class="ft_circle" ></div><div class="ft_circle_space"></div><div class="ft_circle" ></div><div class="ft_circle_space"></div><div class="ft_circle" ></div><div class="ft_circle_space"></div><div class="ft_circle" ></div><div class="ft_circle_space"></div><div class="ft_circle" style="background-color: #2F8CFF; margin-right: 10%;"></div></div></div>'};function PacManIdentify(options){var config={};this.get=function(n){return config[n]};this.set=function(n,v){config[n]=v};function createDom(options){var container=options&&options.container?options.container:"body";var containerEl=document.querySelector(container);var self=this;containerEl.insertAdjacentHTML("beforeend",HTMLS.ovl);var sliderEl=document.querySelector("#wrapper_sd");var ftEl=document.querySelector("#ft_el");var sd_bt=document.querySelector("#sd_bt");var bg_el=document.querySelector("#bg_el");var body=document.querySelector("body");var pk_man=document.querySelector("#pk_man");var pk_man_success=document.querySelector("#pk_man_success");var pk_man_fail=document.querySelector("#pk_man_fail");var last_bean=document.querySelector("#ft_el .ft_circle:last-child");sliderEl.style.width=options&&options.width?options.width:"100%";sliderEl.style.height=options&&options.height?options.height:"100%";sliderEl.style.lineHeight=sliderEl.style.height;this.set("ovl",sliderEl);this.set("ftEl",ftEl);this.set("sd_bt",sd_bt);this.set("bg_el",bg_el);this.set("body",body);this.set("pk_man",pk_man);this.set("pk_man_success",pk_man_success);this.set("pk_man_fail",pk_man_fail);this.set("destroy",destroy);this.set("tryTimes",0);this.set("onComplete",options.onComplete);this.set("last_bean",last_bean);this.set("trace",{beforeStart:[],startMouseDown:[],startMouseMove:[],endMouseUp:[],tryTimes:0,payload:options.payload});if(navigator.appVersion.indexOf("MSIE 9.")!==-1){(function(){function rotation(state){document.querySelector(".pkman_eating1").style.msTransform=state===0?"rotate(0deg)":"rotate(35deg)";document.querySelector(".pkman_eating1").style.msTransformOrigin="27.5px 24px";document.querySelector(".pkman_eating2").style.msTransform=state===0?"rotate(0deg)":"rotate(-35deg)";document.querySelector(".pkman_eating2").style.msTransformOrigin="26px 22px;"}var count=0;var id=setInterval(function(){rotation(count%2);count+=1},400);self.set("intervalId",id)})()}}function destroy(){var bt=this.get("sd_bt"),body=this.get("body"),intervalId=this.get("intervalId");bt.removeEventListener("mousedown",mouseDown);body.removeEventListener("mouseup",endMove);bt.removeEventListener("touchstart",mouseDown);body.removeEventListener("touchend",endMove);body.removeEventListener("mousemove",mouseMove);body.removeEventListener("touchmove",mouseMove);clearInterval(intervalId)}function bindEvent(){var _this=this,bt=_this.get("sd_bt"),ovl=this.get("ovl"),body=this.get("body");bt.addEventListener("mousedown",mouseDown);body.addEventListener("mouseup",endMove);bt.addEventListener("touchstart",mouseDown);body.addEventListener("touchend",endMove);body.addEventListener("mousemove",bodyMove)}function bodyMove(e){var pageX;var pageY;if(e.touches){pageX=e.touches[0].pageX;pageY=e.touches[0].pageY}else{pageX=e.pageX;pageY=e.pageY}addTraceData("beforeStart",[pageX,pageY,(new Date).getTime()])}function traceBtDown(e){var pageX;var pageY;if(e.touches){pageX=e.touches[0].pageX;pageY=e.touches[0].pageY}else{pageX=e.pageX;pageY=e.pageY}addTraceData("startMouseDown",[pageX,pageY,(new Date).getTime()],true);addTraceData("startMouseMove",null,true)}function traceBtMove(e){var pageX;var pageY;if(e.touches){pageX=e.touches[0].pageX;pageY=e.touches[0].pageY}else{pageX=e.pageX;pageY=e.pageY}addTraceData("startMouseMove",[pageX,pageY,(new Date).getTime()])}function traceBtUp(e){var pageX;var pageY;if(e.changedTouches){pageX=e.changedTouches[0].pageX;pageY=e.changedTouches[0].pageY}else{pageX=e.pageX;pageY=e.pageY}addTraceData("endMouseUp",[pageX,pageY,(new Date).getTime()],true);addTraceData("tryTimes",this.get("tryTimes"),true);var onComplete=this.get("onComplete");if(onComplete){onComplete(this.get("trace"))}}function addTraceData(type,data,reset){var trace=this.get("trace");if(reset){trace[type]=[]}if(type==="tryTimes"&&data){trace[type]=data}else if(data){trace[type].push(data)}}function sendResult(){var trace=this.get("trace");var http=new XMLHttpRequest;var url=location.pathname.match(/robot/)?"http://"+window.location.host+"/trace/robot":"http://"+window.location.host+"/trace";var params=JSON.stringify(trace);http.open("POST",url,true);http.onreadystatechange=function(){if(http.readyState==4&&http.status==200){success()}};http.send(params)}function initState(){var pk_man=this.get("pk_man"),pk_man_success=this.get("pk_man_success"),pk_man_fail=this.get("pk_man_fail");pk_man.style.display="block";pk_man_fail.style.display="none";pk_man_success.style.display="none"}function success(){var pk_man=this.get("pk_man"),pk_man_success=this.get("pk_man_success"),pk_man_fail=this.get("pk_man_fail");pk_man.style.display="none";pk_man_fail.style.display="none";pk_man_success.style.display="block"}function fail(){var pk_man=this.get("pk_man"),pk_man_success=this.get("pk_man_success"),pk_man_fail=this.get("pk_man_fail");pk_man.style.display="none";pk_man_success.style.display="none";pk_man_fail.style.display="block"}function mouseDown(e){var _this=this,bt=_this.get("sd_bt"),body=this.get("body"),times=this.get("tryTimes");traceBtDown(e);body.removeEventListener("mousemove",bodyMove);times++;this.set("tryTimes",times);if(e.touches){this.set("s_position",{x:e.touches[0].pageX,y:e.touches[0].pageY});body.addEventListener("touchmove",mouseMove)}else{this.set("s_position",{x:e.pageX,y:e.pageY});body.addEventListener("mousemove",mouseMove)}}function mouseMove(e){var s_position=this.get("s_position");var bt=this.get("sd_bt");var bg_el=this.get("bg_el");var ovl=this.get("ovl");traceBtMove(e);var moveX=e.pageX;if(e.touches){moveX=e.touches[0].pageX}var moveLeft=moveX-s_position.x;moveLeft=moveLeft>ovl.offsetWidth-bt.offsetWidth?ovl.offsetWidth-bt.offsetWidth:moveLeft;moveLeft=moveLeft<0?0:moveLeft;bt.style.left=moveLeft+"px";bg_el.style.width=moveLeft+30+"px"}function endMove(e){var _this=this,bt=_this.get("sd_bt"),bg_el=this.get("bg_el"),body=this.get("body"),ovl=this.get("ovl");var btLeft=bt.getBoundingClientRect().left+bt.getBoundingClientRect().width;var last_bean=this.get("last_bean");var beanLeft=last_bean.getBoundingClientRect().left;if(btLeft>=beanLeft){traceBtUp(e);startMove(bt,{left:ovl.offsetWidth-bt.offsetWidth});bt.removeEventListener("mousedown",mouseDown);body.removeEventListener("mouseup",endMove);bt.removeEventListener("touchstart",mouseDown);body.removeEventListener("touchend",endMove)}else{fail();ovl.className+="shake";setTimeout(function(){ovl.className=ovl.className.replace(/shake/gi,"");startMove(bt,{left:0});startMove(bg_el,{width:0});initState()},1e3)}body.removeEventListener("mousemove",mouseMove);body.removeEventListener("touchmove",mouseMove)}function startMove(obj,json){clearInterval(obj.timer);var self=this;obj.timer=setInterval(function(){var bBtn=true;for(var attr in json){var iCur=0;if(attr=="opacity"){if(Math.round(parseFloat(getStyle(obj,attr))*100)==0){iCur=Math.round(parseFloat(getStyle(obj,attr))*100)}else{iCur=Math.round(parseFloat(getStyle(obj,attr))*100)||100}}else{iCur=parseInt(getStyle(obj,attr))||0}var iSpeed=(json[attr]-iCur)/5;iSpeed=iSpeed>0?Math.ceil(iSpeed):Math.floor(iSpeed);if(iCur!=json[attr]){bBtn=false}if(attr=="opacity"){obj.style.filter="alpha(opacity="+(iCur+iSpeed)+")";obj.style.opacity=(iCur+iSpeed)/100}else{obj.style[attr]=iCur+iSpeed+"px"}}if(bBtn){clearInterval(obj.timer)}},30)}function getStyle(obj,attr){if(obj.currentStyle){return obj.currentStyle[attr]}else{return getComputedStyle(obj,false)[attr]}}var createDom=createDom.bind(this,options);var bindEvent=bindEvent.bind(this);var mouseMove=mouseMove.bind(this);var mouseDown=mouseDown.bind(this);var endMove=endMove.bind(this);var bodyMove=bodyMove.bind(this);var traceBtUp=traceBtUp.bind(this);var addTraceData=addTraceData.bind(this);var sendResult=sendResult.bind(this);var initState=initState.bind(this);var success=success.bind(this);var fail=fail.bind(this);var destroy=destroy.bind(this);function init(options){createDom(options);bindEvent()}init(options)}PacManIdentify.prototype={destroy:function(){var destroy=this.get("destroy");destroy()}};window.PacManIdentify=PacManIdentify})(window);(function(global,factory){if(typeof define==="function"&&define.amd){define(["exports","module"],factory)}else if(typeof exports!=="undefined"&&typeof module!=="undefined"){factory(exports,module)}else{var mod={exports:{}};factory(mod.exports,mod);global.fetchJsonp=mod.exports}})(this,function(exports,module){"use strict";var defaultOptions={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function generateCallbackFunction(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function clearFunction(functionName){try{delete window[functionName]}catch(e){window[functionName]=undefined}}function removeScript(scriptId){var script=document.getElementById(scriptId);document.getElementsByTagName("head")[0].removeChild(script)}function fetchJsonp(_url){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var url=_url;var timeout=options.timeout||defaultOptions.timeout;var jsonpCallback=options.jsonpCallback||defaultOptions.jsonpCallback;var timeoutId=undefined;return new Promise(function(resolve,reject){var callbackFunction=options.jsonpCallbackFunction||generateCallbackFunction();var scriptId=jsonpCallback+"_"+callbackFunction;window[callbackFunction]=function(response){resolve({ok:true,json:function json(){return Promise.resolve(response)}});if(timeoutId)clearTimeout(timeoutId);removeScript(scriptId);clearFunction(callbackFunction)};url+=url.indexOf("?")===-1?"?":"&";var jsonpScript=document.createElement("script");jsonpScript.setAttribute("src",""+url+jsonpCallback+"="+callbackFunction);if(options.charset){jsonpScript.setAttribute("charset",options.charset)}jsonpScript.id=scriptId;document.getElementsByTagName("head")[0].appendChild(jsonpScript);timeoutId=setTimeout(function(){reject(new Error("JSONP request to "+_url+" timed out"));clearFunction(callbackFunction);removeScript(scriptId)},timeout)})}module.exports=fetchJsonp});!function(e){function n(){}function t(e,n){return function(){e.apply(n,arguments)}}function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(e,this)}function i(e,n){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(n):(e._handled=!0,void o._immediateFn(function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null===t)return void(1===e._state?r:u)(n.promise,e._value);var o;try{o=t(e._value)}catch(i){return void u(n.promise,i)}r(n.promise,o)}))}function r(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var i=n.then;if(n instanceof o)return e._state=3,e._value=n,void f(e);if("function"==typeof i)return void s(t(i,n),e)}e._state=1,e._value=n,f(e)}catch(r){u(e,r)}}function u(e,n){e._state=2,e._value=n,f(e)}function f(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var n=0,t=e._deferreds.length;n<t;n++)i(e,e._deferreds[n]);e._deferreds=null}function c(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function s(e,n){var t=!1;try{e(function(e){t||(t=!0,r(n,e))},function(e){t||(t=!0,u(n,e))})}catch(o){if(t)return;t=!0,u(n,o)}}var a=setTimeout;o.prototype["catch"]=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var o=new this.constructor(n);return i(this,new c(e,t,o)),o},o.all=function(e){var n=Array.prototype.slice.call(e);return new o(function(e,t){function o(r,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var f=u.then;if("function"==typeof f)return void f.call(u,function(e){o(r,e)},t)}n[r]=u,0===--i&&e(n)}catch(c){t(c)}}if(0===n.length)return e([]);for(var i=n.length,r=0;r<n.length;r++)o(r,n[r])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(n){n(e)})},o.reject=function(e){return new o(function(n,t){t(e)})},o.race=function(e){return new o(function(n,t){for(var o=0,i=e.length;o<i;o++)e[o].then(n,t)})},o._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){a(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},o._setImmediateFn=function(e){o._immediateFn=e},o._setUnhandledRejectionFn=function(e){o._unhandledRejectionFn=e},"undefined"!=typeof module&&module.exports?module.exports=o:e.Promise||(e.Promise=o)}(this);